# Face Verification During Voting - Visual Flow Guide

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     REACT FRONTEND (Port 3000)                   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            VOTING PAGE (VotingPage.js)                    â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  1. Display Candidates                                   â”‚   â”‚
â”‚  â”‚  2. User Selects Candidate                               â”‚   â”‚
â”‚  â”‚  3. User Clicks "Submit Vote"                            â”‚   â”‚
â”‚  â”‚     â†“                                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  FACE VERIFICATION MODAL (FaceVerificationModal)  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚                                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Request Camera Access                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Load face-api.js models                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Display Live Camera Feed                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Detect Face & Landmarks                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Wait for User Blink                           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Capture Face Image                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Send to Backend (Base64)                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚     â†“                                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  [BACKEND VERIFICATION]                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚     â†“                                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  âœ“ Success OR âœ— Failure                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚     â†“                                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  If Success: Close Modal â†’ Cast Vote            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  If Failure: Show Error â†’ Retry                 â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  4. Results Page Displayed                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘                                                   â†‘
         â”‚ HTTP Requests (API Calls)                        â”‚
         â”‚ Authorization: Bearer <TOKEN>                    â”‚
         â†“                                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FASTAPI BACKEND (Port 8001)                   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  POST /api/face/verify-for-voting                         â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Request Body: { image_data: "base64_encoded_image" }   â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Process:                                                â”‚   â”‚
â”‚  â”‚  1. Decode base64 image data                            â”‚   â”‚
â”‚  â”‚  2. Extract face encoding from image                    â”‚   â”‚
â”‚  â”‚  3. Get current user's registered face encoding         â”‚   â”‚
â”‚  â”‚  4. Compare face encodings (similarity check)           â”‚   â”‚
â”‚  â”‚  5. Return verification result                          â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Response: { verified: true, message: "..." }           â”‚   â”‚
â”‚  â”‚     OR                                                   â”‚   â”‚
â”‚  â”‚  Response: { detail: "Error message" } (HTTP 401)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  POST /api/votes/cast                                     â”‚   â”‚
â”‚  â”‚  (Called after face verification success)                â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Request: { election_id: 1, candidate_id: 5 }           â”‚   â”‚
â”‚  â”‚  Response: { message: "Vote cast successfully" }         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   DATABASE   â”‚
        â”‚              â”‚
        â”‚  - users     â”‚
        â”‚  - faces     â”‚
        â”‚  - votes     â”‚
        â”‚  - elections â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## User Journey - Voting with Face Verification

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Logged In â”‚
â”‚   (Face        â”‚
â”‚  Registered)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Home Page Displayed        â”‚
â”‚  Shows 3 Options:           â”‚
â”‚  - Candidates Campaigning   â”‚
â”‚  - Cast Your Vote â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  - View Results             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Click "Cast Your Vote"
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Voting Page Loaded      â”‚
â”‚                          â”‚
â”‚  [Candidate 1] [ ]       â”‚
â”‚  [Candidate 2] [X]       â”‚
â”‚  [Candidate 3] [ ]       â”‚
â”‚                          â”‚
â”‚  [Submit Vote Button]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Select Candidate & Click Submit
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Face Verification Modal Opens   â”‚
â”‚                                  â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚  â•‘  ğŸ“· Camera Feed            â•‘  â”‚
â”‚  â•‘  (Face Detection Active)   â•‘  â”‚
â”‚  â•‘                            â•‘  â”‚
â”‚  â•‘  [Face Detected]           â•‘  â”‚
â”‚  â•‘  Green Box around face     â•‘  â”‚
â”‚  â•‘  Green Dots on landmarks   â•‘  â”‚
â”‚  â•‘                            â•‘  â”‚
â”‚  â•‘  Blinks: 0/1               â•‘  â•‘
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                  â”‚
â”‚  Status: "Ready to capture..."   â”‚
â”‚                                  â”‚
â”‚  [Cancel Button]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ User Blinks Once
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Face Captured & Uploading       â”‚
â”‚                                  â”‚
â”‚  Status: "Verifying your face..."â”‚
â”‚  ğŸ”„ Loading Spinner              â”‚
â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Backend Verification
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                 â”‚                  â”‚
      SUCCESS           FAILURE          NO FACE
         â”‚                 â”‚                  â”‚
         â–¼                 â–¼                  â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ âœ“ Face  â”‚      â”‚ âœ— Face Not  â”‚  â”‚ âœ— No Face    â”‚
    â”‚Verified â”‚      â”‚ Recognized  â”‚  â”‚ Detected     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚               â”‚
         â–¼                  â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Cast Voteâ”‚         â”‚ Retry  â”‚    â”‚ Retry   â”‚
    â”‚Success  â”‚         â”‚Modal   â”‚    â”‚Modal    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Results Page     â”‚
    â”‚                  â”‚
    â”‚ âœ“ Vote Cast!     â”‚
    â”‚                  â”‚
    â”‚ Show Results     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Face Verification Process (Backend Detail)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FACE VERIFICATION PROCESS                      â”‚
â”‚                                                             â”‚
â”‚  Input: Base64 Encoded Face Image + User Token             â”‚
â”‚                                                             â”‚
â”‚  1. DECODE IMAGE                                           â”‚
â”‚     â”œâ”€ Base64 â†’ Binary Image Data                          â”‚
â”‚     â””â”€ Validate Image Format (JPEG)                        â”‚
â”‚                                                             â”‚
â”‚  2. EXTRACT FACE ENCODING                                  â”‚
â”‚     â”œâ”€ Load Face Detection Model                           â”‚
â”‚     â”œâ”€ Detect Face in Image                                â”‚
â”‚     â”œâ”€ Generate 128-dimensional Face Encoding              â”‚
â”‚     â””â”€ Validate Face Quality (confidence > threshold)      â”‚
â”‚                                                             â”‚
â”‚  3. RETRIEVE STORED ENCODING                               â”‚
â”‚     â”œâ”€ Get Current User ID (from token)                    â”‚
â”‚     â”œâ”€ Query Database for User's Face                      â”‚
â”‚     â””â”€ Deserialize Stored Face Encoding                    â”‚
â”‚                                                             â”‚
â”‚  4. COMPARE ENCODINGS                                      â”‚
â”‚     â”œâ”€ Calculate Euclidean Distance                        â”‚
â”‚     â”‚   - Close = Similar (Match)                          â”‚
â”‚     â”‚   - Far = Different (No Match)                       â”‚
â”‚     â””â”€ Distance < Threshold? â†’ MATCH                       â”‚
â”‚                                                             â”‚
â”‚  5. RESPONSE & LOGGING                                     â”‚
â”‚     â”œâ”€ Update last_used_at timestamp                       â”‚
â”‚     â”œâ”€ Log verification attempt                            â”‚
â”‚     â””â”€ Return Result {verified: true/false}                â”‚
â”‚                                                             â”‚
â”‚  Output: Verification Status (true/false)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Distance Calculation Example:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Registered Face Encoding:
[0.234, 0.567, -0.123, ..., 0.891]  (128 values)

Captured Face Encoding:
[0.235, 0.568, -0.122, ..., 0.890]  (128 values)

Euclidean Distance = âˆš((0.234-0.235)Â² + (0.567-0.568)Â² + ... )
                   = 0.045  (MATCH - close to registered)

Threshold = 0.6 (typically)
0.045 < 0.6 â†’ âœ“ MATCH (VERIFIED)
```

## Component Communication Diagram

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   VotingPage    â”‚
                    â”‚   (Parent)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                        â”‚
                â–¼                        â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Candidates  â”‚        â”‚ FaceVerificationModalâ”‚
         â”‚   Display    â”‚        â”‚     (Modal)          â”‚
         â”‚              â”‚        â”‚                      â”‚
         â”‚  [Select]    â”‚        â”‚  - Camera Control    â”‚
         â”‚  [Submit]â—„â”€â”€â”€â”¼â”€â”€â”€â”€â”€â–º â”‚  - Face Detection    â”‚
         â”‚              â”‚        â”‚  - API Call          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  - Response Handle   â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚    api.js      â”‚
                                    â”‚                â”‚
                                    â”‚verifyFaceFor   â”‚
                                    â”‚Voting(image)   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                              HTTP POST to Backend
                                             â”‚
                                             â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Backend Endpoint  â”‚
                                    â”‚ /api/face/verify-  â”‚
                                    â”‚ for-voting         â”‚
                                    â”‚                    â”‚
                                    â”‚ - Decode Image     â”‚
                                    â”‚ - Compare Faces    â”‚
                                    â”‚ - Return Result    â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                    Response to Frontend
                                             â”‚
                                             â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Update Modal  â”‚
                                    â”‚  Status        â”‚
                                    â”‚  & Close on    â”‚
                                    â”‚  Success       â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Cast Vote     â”‚
                                    â”‚  & Redirect    â”‚
                                    â”‚  to Results    â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Error Handling Flow

```
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  Face Verification  â”‚
                      â”‚     Attempted       â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚
                    â–¼                         â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  SUCCESS     â”‚          â”‚  FAILURE     â”‚
            â”‚              â”‚          â”‚              â”‚
            â”‚ âœ“ Face Match â”‚          â”‚ âœ— Error      â”‚
            â”‚              â”‚          â”‚              â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                         â”‚
                   â–¼                         â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚Close Modal   â”‚      â”‚Show Error Msg   â”‚
            â”‚Cast Vote     â”‚      â”‚Options:         â”‚
            â”‚Show Results  â”‚      â”‚- Try Again      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚- Cancel/Back    â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚What Error?       â”‚
                                  â”‚                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚             â”‚                 â”‚
                    â–¼             â–¼                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚Face Not        â”‚ â”‚No Face    â”‚ â”‚Camera        â”‚
         â”‚Registered      â”‚ â”‚Detected   â”‚ â”‚Permission    â”‚
         â”‚"Register face" â”‚ â”‚"Repositionâ”‚ â”‚"Allow camera"â”‚
         â”‚first"          â”‚ â”‚ face"     â”‚ â”‚permission"   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## State Management

```
VotingPage State:
â”œâ”€ candidates: []                    (List of candidates)
â”œâ”€ loading: boolean                  (Loading state)
â”œâ”€ error: string                     (Error messages)
â”œâ”€ selectedCandidate: number         (Selected candidate ID)
â”œâ”€ hasVoted: boolean                 (Vote already cast?)
â”œâ”€ showFaceVerification: boolean     (Modal visibility)
â””â”€ faceVerified: boolean             (Verification completed?)

FaceVerificationModal State:
â”œâ”€ loading: boolean                  (Initial loading)
â”œâ”€ error: string                     (Error messages)
â”œâ”€ blinkCount: number                (Blinks detected: 0 or 1)
â”œâ”€ status: string                    (Status message)
â””â”€ modelLoaded: boolean              (Face-api models ready?)

Refs:
â”œâ”€ videoRef                          (Video element reference)
â””â”€ canvasRef                         (Canvas overlay reference)
```

---

**This comprehensive visual guide shows how face verification integrates seamlessly into the voting process, from user perspective and system architecture.**
